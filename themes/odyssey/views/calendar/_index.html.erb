<div class='calendar'>
  <div class='month clearfix'>
    <!-- How do you make RoR spit out a link without generating an a tag? -->
    <!--
    <%= link_to root_path(date: @date.prev_month), class: 'button prev' do %>
      <i class='chevron chevron'></i> Prev Month
    <% end %>
    -->
    <div class='month-name-container month-selector'>
      <span class='month-name'>
        <%= @date.strftime("%B"); %>
      </span>
      <button class="month-select-button"><%= image_tag('select-arrow.svg') %></button>
      <select class="month-select js-month-select">
          <option value="January">January</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5</option>
          <option value="6">6</option>
          <option value="7">7</option>
          <option value="8">8</option>
      </select>
    </div>

    <!-- <span class='year'>
      <%= @date.strftime("%Y") %>
    </span> -->

    <!--
    <%= link_to root_path(date: @date.next_month), class: 'button next' do %>
      Next Month <i class='chevron chevron--direction-right'></i>
    <% end %>
    -->
  </div>
  <script>
    $(function() {
      $('td .no-events').parent('td').addClass('no-events');
    });
  </script>
  <% if events_this_month? %>
    <%= calendar @date do |date| %>
      <div class='date'>
        <span class="monthname"><%= date.strftime('%b') %></span>
        <span class="daynumber"><%= date.day %></span>
        <span class="dayofweek"><%= date.strftime('%A') %></span>
        <span class="yearnumber"><%= date.strftime('%Y') %></span>
      </div>
      <% if (events=events_for_date(date,@events)).any? %>
        <ul>
          <% events.first(4).each do |event| %>
            <li>
                <% if event.organization.present? %>
                  <%=link_to(event.organization_title, event.organization, :class => 'organization-name', :target => "_blank") %><br />
                <% end %>
                <%= link_to event.title, event, :class => "event-title", :target => "_blank" %>
                <div class='event-time'>
                  <span class='event-start-time'><%= event.start_time.strftime("%I:%M %p") %></span> - <span class='event-end-time'><%= event.end_time.strftime("%I:%M %p") %>
                </span>
                </div>
            </li>
          <% end %>
        </ul>

        <% if events.length > 4 %>
          <%= link_to events_path({date: {start: events.first.start_date, end: events.first.start_date } }), class: 'button button--call-to-action view-more-events' do %>
              <span>And <%= events.length - 4 %> more events.</span>
          <% end %>
        <% end %>

      <% else %>
        <div class='no-events'>
      <% end %>
    <% end %>
  <% else %>
    <div class='no-events'>
      <p>No events this month.</p>
    </div>
  <% end %>
</div>
