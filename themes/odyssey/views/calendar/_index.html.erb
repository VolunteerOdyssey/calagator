<div class='calendar'>
  <div class='month clearfix'>
    <!-- How do you make RoR spit out a link without generating an a tag? -->
    <!--
    <%= link_to root_path(date: @date.prev_month), class: 'button prev' do %>
      <i class='chevron chevron'></i> Prev Month
    <% end %>
    -->
    <div class='month-name-container month-selector'>
      <span class='month-name'>
        <%= @date.strftime("%B"); %>
      </span>
      <button class="month-select-button"><%= image_tag('select-arrow.svg') %></button>
      <select class="month-select js-month-select">
          <option value="January">January</option>
          <option value="2">February</option>
          <option value="3">March</option>
          <option value="4">April</option>
          <option value="5">May</option>
          <option value="6">6</option>
          <option value="7">7</option>
          <option value="8">8</option>
      </select>
    </div>

    <!-- <span class='year'>
      <%= @date.strftime("%Y") %>
    </span> -->

    <!--
    <%= link_to root_path(date: @date.next_month), class: 'button next' do %>
      Next Month <i class='chevron chevron--direction-right'></i>
    <% end %>
    -->
  </div>
  <script>
    $(function() {
      $('td .no-events').parent('td').addClass('no-events');
    });
  </script>
  <% if events_this_month? %>
    <%= calendar @date do |date| %>
      <div class='date'>
        <span class="monthname"><%= date.strftime('%b') %></span>
        <span class="daynumber"><%= date.day %></span>
        <span class="dayofweek"><%= date.strftime('%A') %></span>
        <span class="yearnumber"><%= date.strftime('%Y') %></span>
        <span class="isToday">
            <% if date.to_date == Date.today %>(Today)<% end %>
        </span>
      </div>
      <% if (events=events_for_date(date,@events)).any? %>
        <ul>
          <% events.first(4).each do |event| %>
            <li class="Event">
                <div class='Event--time'>
                    <span class="Event--timeStart"><%= event.start_time.strftime("%I:%M") %></span>
                    <span class="Event--timeStartMeridiem"><%= event.start_time.strftime("%p") %></span>
              </div>

              <div class="Event--content">
                  <div class="Event--timeEnd">until <%= event.end_time.strftime("%I:%M %p") %></div>
                  <div class="Event--title js-event-title"><%= link_to event.title, event, :target => "_blank" %></div>
              </div>
            </li>
          <% end %>
        </ul>

        <% if events.length > 4 %>
          <%= link_to events_path({date: {start: events.first.start_date, end: events.first.start_date } }), class: 'button button--call-to-action view-more-events' do %>
              <span>And <%= events.length - 4 %> more events.</span>
          <% end %>
        <% end %>

      <% else %>
        <div class='no-events'>
      <% end %>
    <% end %>
  <% else %>
    <div class='no-events'>
      <p>No events this month.</p>
    </div>
  <% end %>
</div>
